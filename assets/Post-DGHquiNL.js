import{_ as k,r as f,l as m,o as r,c as d,g as C,h as U,j as S,t as P,w as L,v as T,i as v,a as s,F as w,e as I}from"./index-CJgp8Si2.js";const O="34447c68-f891-40ce-a165-2b541f2a0e17",B="https://content-api.boberneprotiv.com/",l=async(e,a,n)=>{try{const t=await fetch(B+e,{method:a,headers:{"Content-Type":"application/json",Authorization:O},body:JSON.stringify(n)});if(t.ok)return a==="DELETE"||a==="PUT"?void 0:await t.json()}catch(t){throw new Error(t)}},z=async e=>await l(`publications?order=${e}`),K=async e=>{if(e)return await l("publications","POST",{content:e})},Y=async e=>await l(`publications/${e}`),x=async(e,a)=>{if(a)return await l(`publications/${e}`,"PUT",{content:a})},M=async e=>await l(`publications/${e}`,"DELETE"),N={props:{post:{type:Object,default:()=>{},required:!0}},emits:["delete","update"],setup(e,a){const n=f(!1),t=f(""),c=f(!1),u=f(!1),y=()=>n.value=!0,o=()=>{n.value=!1,t.value=""},E=async()=>{if(!u.value){try{u.value=!0,await M(e.post.id)}catch(i){console.error("[deletePostHandler]:",i.message)}finally{u.value=!1}a.emit("delete")}},_=async()=>{if(!(c.value||!t.value||t.value===e.post.content)){try{c.value=!0,await x(e.post.id,t.value)}catch(i){console.error("[updatePostHandler]:",i.message)}finally{c.value=!1}a.emit("update"),o()}},b=m(()=>{const i=new Date,p=new Date(e.post.createdOn),g=Math.floor((i-p)/1e3),H=p.toDateString()===i.toDateString();return g<60?"Just now":g<3600?"Less than 1 hour ago":H?p.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):p.toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(",","")}),D=m(()=>e.post.updatedOn?new Date(e.post.createdOn).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(",",""):""),h=m(()=>e.post.createdOn!==e.post.updatedOn);return{isEditMode:n,updatedContent:t,formattedCreateDate:b,formattedUpdateDate:D,isPostUpdated:h,openEditHandler:y,closeEditHandler:o,deletePostHandler:E,updatePostHandler:_}}},V={class:"publication"},j={class:"meta"},A={class:"date"},R=["data-tooltip"],q={class:"actions"};function F(e,a,n,t,c,u){const y=I("RouterLink");return r(),d("div",V,[C(y,{class:"content",to:{name:"Post",params:{postId:n.post.id}}},{default:U(()=>[S(P(n.post.content),1)]),_:1},8,["to"]),t.isEditMode?L((r(),d("input",{key:0,type:"text",placeholder:"write updated content..","onUpdate:modelValue":a[0]||(a[0]=o=>t.updatedContent=o)},null,512)),[[T,t.updatedContent]]):v("",!0),s("div",j,[s("span",A,"Published on: "+P(t.formattedCreateDate),1),t.isPostUpdated?(r(),d("span",{key:0,class:"updated","data-tooltip":`Last updated: ${t.formattedUpdateDate}`},"ðŸ›ˆ",8,R)):v("",!0)]),s("div",q,[t.isEditMode?(r(),d(w,{key:0},[s("button",{onClick:a[1]||(a[1]=(...o)=>t.closeEditHandler&&t.closeEditHandler(...o))},"Undo"),s("button",{onClick:a[2]||(a[2]=(...o)=>t.updatePostHandler&&t.updatePostHandler(...o))},"Update")],64)):(r(),d(w,{key:1},[s("button",{onClick:a[3]||(a[3]=(...o)=>t.openEditHandler&&t.openEditHandler(...o))},"Edit"),s("button",{onClick:a[4]||(a[4]=(...o)=>t.deletePostHandler&&t.deletePostHandler(...o))},"Delete")],64))])])}const G=k(N,[["render",F],["__scopeId","data-v-c414401d"]]);export{G as P,Y as a,K as c,z as g};
